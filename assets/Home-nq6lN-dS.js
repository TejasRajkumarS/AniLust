import{c as d,j as e}from"./index-Cy-imd_x.js";import{b as a,L as N}from"./vendor-Btvvx3Fo.js";import{A as x}from"./AnimeCard-BQ3C_kDD.js";const L=["Action","Adventure","Comedy","Drama","Fantasy","Horror","Mystery","Psychological","Romance","Sci-Fi","Slice of Life","Sports","Supernatural","Thriller"],W=({showToast:O})=>{const[i,p]=a.useState([]),[w,g]=a.useState([]),[k,S]=a.useState([]),[u,E]=a.useState([]),[_,h]=a.useState(!1),[I,f]=a.useState(!1),[r,b]=a.useState(null);a.useEffect(()=>{const t=localStorage.getItem("cache_trending_v2"),s=localStorage.getItem("cache_recent_v2");t&&p(JSON.parse(t)),s&&g(JSON.parse(s))},[]);const y=a.useCallback(async()=>{try{i.length===0&&h(!0);const t=JSON.parse(localStorage.getItem("anime_history")||"{}"),s=Object.keys(t).reverse().slice(0,8),[c,o]=await Promise.allSettled([d.getTrending(1),d.getRecent(1)]);if(c.status==="fulfilled"&&c.value.results.length>0&&(p(c.value.results),localStorage.setItem("cache_trending_v2",JSON.stringify(c.value.results))),o.status==="fulfilled"&&o.value.results.length>0&&(g(o.value.results),localStorage.setItem("cache_recent_v2",JSON.stringify(o.value.results))),s.length>0){const T=(await Promise.allSettled(s.map(n=>d.getInfo(n)))).filter(n=>n.status==="fulfilled").map(n=>{var v;const m=n.value,j=t[m.id]||[],C=j[j.length-1],G=(v=m.episodes)==null?void 0:v.find($=>$.id===C);return{...m,lastEp:G}});E(T)}}catch(t){console.error(t)}finally{h(!1)}},[i.length]);if(a.useEffect(()=>{y()},[y]),a.useEffect(()=>{(async()=>{if(r){f(!0);try{const s=await d.getByGenre(r,1);S(s.results||[])}catch(s){console.error(s)}finally{f(!1)}}})()},[r]),_)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-[70vh] gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-[3px] border-white/5 border-t-primary"}),e.jsx("p",{className:"text-slate-500 font-black tracking-widest uppercase text-[10px]",children:"Syncing Multiverse..."})]});const l=i.length>0?i[0]:null,R=l?typeof l.title=="string"?l.title:l.title.english||l.title.romaji:"";return e.jsxs("div",{className:"pb-12 md:pb-20",children:[l&&!r&&e.jsxs("section",{className:"relative h-[450px] md:h-[600px] w-full group overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-transform duration-[10s] ease-linear group-hover:scale-110",style:{backgroundImage:`linear-gradient(to right, rgba(5, 5, 5, 1) 5%, rgba(5, 5, 5, 0.4) 50%, rgba(5, 5, 5, 0) 100%), url(${l.cover||l.image})`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background-dark via-transparent to-transparent"}),e.jsxs("div",{className:"relative h-full flex flex-col justify-end md:justify-center px-6 md:px-16 max-w-5xl z-10 animate-fade-in pb-12 md:pb-0",children:[e.jsx("span",{className:"text-primary font-black uppercase tracking-[0.3em] text-[10px] mb-3",children:"Trending Sector"}),e.jsx("h1",{className:"text-white text-3xl md:text-6xl font-black leading-tight tracking-tighter mb-6 md:mb-8 drop-shadow-2xl line-clamp-2",children:R}),e.jsx("div",{className:"flex flex-wrap gap-4",children:e.jsxs(N,{to:`/info/${l.id}`,className:"bg-primary hover:bg-primary/90 text-white px-8 md:px-10 py-4 md:py-5 rounded-2xl font-black flex items-center gap-3 transition-all active:scale-95 shadow-xl text-sm md:text-lg focus:ring-4 focus:ring-primary/50 outline-none",children:[e.jsx("span",{className:"material-symbols-outlined !text-2xl md:!text-3xl",children:"play_circle"})," WATCH NOW"]})})]})]}),e.jsx("section",{className:`px-4 md:px-12 relative z-40 ${r?"mt-8":"mt-[-30px] md:mt-[-40px] mb-12"}`,children:e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto hide-scrollbar pb-2",children:[e.jsx("button",{onClick:()=>b(null),className:`px-5 py-2.5 rounded-xl text-[10px] font-black tracking-widest uppercase transition-all whitespace-nowrap border focus:ring-4 focus:ring-primary/20 outline-none ${r?"bg-card-dark border-white/10 text-slate-400":"bg-primary border-primary text-white"}`,children:"All"}),L.map(t=>e.jsx("button",{onClick:()=>b(t),className:`px-5 py-2.5 rounded-xl text-[10px] font-black tracking-widest uppercase transition-all whitespace-nowrap border focus:ring-4 focus:ring-primary/20 outline-none ${r===t?"bg-primary border-primary text-white":"bg-card-dark border-white/10 text-slate-400"}`,children:t},t))]})}),e.jsxs("div",{className:"px-4 md:px-12 space-y-16 mt-8",children:[u.length>0&&!r&&e.jsxs("section",{className:"animate-fade-in",children:[e.jsx("h2",{className:"text-lg font-black tracking-tight uppercase mb-6 text-slate-400",children:"Continue Watching"}),e.jsx("div",{className:"flex gap-4 md:gap-6 overflow-x-auto hide-scrollbar pb-4",children:u.map(t=>{var s;return e.jsxs(N,{to:t.lastEp?`/watch/${t.lastEp.id}?animeId=${t.id}`:`/info/${t.id}`,className:"flex-none w-64 md:w-72 group relative overflow-hidden rounded-2xl border border-white/5 bg-card-dark focus:ring-4 focus:ring-primary outline-none",children:[e.jsxs("div",{className:"aspect-video relative overflow-hidden",children:[e.jsx("img",{src:t.image,className:"w-full h-full object-cover opacity-60 group-hover:scale-110 transition-transform duration-700",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"size-12 rounded-full bg-primary/20 backdrop-blur-md border border-primary/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("span",{className:"material-symbols-outlined text-white !text-2xl",children:"play_arrow"})})})]}),e.jsxs("div",{className:"p-3 md:p-4",children:[e.jsx("h4",{className:"text-white font-black truncate text-xs md:text-sm",children:typeof t.title=="string"?t.title:t.title.english||t.title.romaji}),e.jsxs("p",{className:"text-[10px] font-bold text-slate-500 mt-1 uppercase tracking-widest",children:["Episode ",((s=t.lastEp)==null?void 0:s.number)||"?"]})]}),e.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-primary w-[65%]"})]},t.id)})})]}),r?e.jsxs("section",{className:"animate-fade-in",children:[e.jsxs("h2",{className:"text-2xl font-black tracking-tighter uppercase mb-10",children:[r," Sector"]}),I?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-primary"})}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-7 2xl:grid-cols-8 gap-x-4 md:gap-x-8 gap-y-10 md:gap-y-12",children:k.map(t=>e.jsx(x,{anime:t},t.id))})]}):e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"animate-fade-in",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-black tracking-tight uppercase mb-8",children:"Trending Now"}),e.jsx("div",{className:"flex gap-4 md:gap-8 overflow-x-auto hide-scrollbar pb-8",children:i.slice(l?1:0,15).map(t=>e.jsx(x,{anime:t},t.id))})]}),e.jsxs("section",{className:"animate-fade-in",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-black tracking-tight uppercase mb-8",children:"Latest Episodes"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-4 md:gap-8",children:w.slice(0,12).map(t=>e.jsx(x,{anime:t,variant:"horizontal"},t.id))})]})]})]})]})};export{W as default};
